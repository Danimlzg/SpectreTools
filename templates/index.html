<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SPECTRE TANK ¬∑ MASSIVE ATTACK</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Inter', 'Segoe UI', monospace;
            background: #0a0c0f;
            color: #e5e9f0;
            padding: 20px;
        }
        .container { max-width: 1800px; margin: 0 auto; }
        
        .header {
            background: linear-gradient(135deg, #1a1c27 0%, #1e1f2b 100%);
            border: 1px solid #2d2f3a;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
            border-left: 5px solid #f44336;
        }
        
        .title {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        
        .title h1 {
            font-size: 32px;
            background: linear-gradient(135deg, #f44336, #ff8a80);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .badge {
            background: #2d2f3a;
            padding: 6px 14px;
            border-radius: 30px;
            font-size: 12px;
            border: 1px solid #f44336;
            color: #ff8a80;
        }
        
        .attack-input {
            display: flex;
            gap: 12px;
        }
        
        .attack-input input {
            flex: 1;
            background: #0f1117;
            border: 1px solid #2d2f3a;
            border-radius: 12px;
            padding: 16px 20px;
            color: #fff;
            font-size: 16px;
            font-family: monospace;
        }
        
        .attack-btn {
            background: linear-gradient(135deg, #f44336, #d32f2f);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 16px 40px;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: 0.2s;
        }
        
        .attack-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(244, 67, 54, 0.4);
        }
        
        .attack-btn:disabled {
            opacity: 0.6;
            cursor: wait;
        }
        
        .status-box {
            background: #1a1c27;
            border: 1px solid #2d2f3a;
            border-radius: 16px;
            padding: 40px;
            text-align: center;
            margin: 20px 0;
        }
        
        .progress-bar {
            width: 100%;
            height: 10px;
            background: #0f1117;
            border-radius: 5px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #f44336, #ff8a80);
            width: 0%;
            transition: width 0.3s;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }
        
        .full-width { grid-column: 1 / -1; }
        .half-width { grid-column: span 2; }
        
        .card {
            background: #1a1c27;
            border: 1px solid #2d2f3a;
            border-radius: 16px;
            overflow: hidden;
        }
        
        .card-header {
            padding: 14px 18px;
            border-bottom: 1px solid #2d2f3a;
            background: #1e1f2b;
            color: #f44336;
            font-weight: 600;
            font-size: 14px;
            display: flex;
            justify-content: space-between;
        }
        
        .card-content {
            padding: 18px;
            max-height: 400px;
            overflow-y: auto;
            background: #161822;
        }
        
        .screenshot-container {
            text-align: center;
            background: #0f1117;
            border-radius: 8px;
            padding: 10px;
        }
        
        .screenshot-container img {
            max-width: 100%;
            max-height: 400px;
            border-radius: 8px;
            border: 1px solid #2d2f3a;
        }
        
        .finding {
            padding: 12px 16px;
            background: #0f1117;
            border-radius: 8px;
            margin-bottom: 8px;
            border-left: 4px solid;
            font-size: 12px;
            font-family: monospace;
            word-break: break-all;
        }
        
        .finding.critical { border-left-color: #f44336; background: #2a1a1a; }
        .finding.warning { border-left-color: #ffa726; background: #2a241a; }
        .finding.info { border-left-color: #64b5f6; background: #1a242a; }
        .finding.success { border-left-color: #66bb6a; background: #1a2a1a; }
        .finding.telegram { border-left-color: #0088cc; background: #1a2a3a; }
        .finding.email { border-left-color: #ea4335; background: #2a1a1a; }
        .finding.key { border-left-color: #f4b400; background: #2a2a1a; }
        
        .tool-output {
            background: #0f1117;
            border-radius: 8px;
            padding: 16px;
            font-family: monospace;
            font-size: 11px;
            white-space: pre-wrap;
            max-height: 500px;
            overflow-y: auto;
            border: 1px solid #2d2f3a;
            line-height: 1.5;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .stat {
            background: #0f1117;
            border: 1px solid #2d2f3a;
            border-radius: 8px;
            padding: 12px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #f44336;
        }
        
        .stat-label {
            font-size: 11px;
            color: #a0a4b8;
            text-transform: uppercase;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="title">
                <h1>‚ö° SPECTRE TANK ¬∑ MASSIVE ATTACK</h1>
                <span class="badge">v25.0 ¬∑ TELEGRAM HUNTER</span>
            </div>
            
            <div class="attack-input">
                <input type="text" id="targetUrl" 
                       placeholder="https://objetivo-phishing.com">
                <button onclick="startAttack()" id="attackBtn" class="attack-btn">
                    üöÄ INICIAR ATAQUE MASIVO
                </button>
            </div>
        </div>

        <div id="statusContainer" style="display: none;">
            <div class="status-box">
                <h2 style="color: #f44336; margin-bottom: 20px;" id="statusTitle">
                    ‚ö° ATAQUE EN PROGRESO
                </h2>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <p id="statusMessage" style="color: #a0a4b8; margin-top: 20px; font-size: 16px;">
                    Inicializando...
                </p>
                <p style="color: #6b7080; margin-top: 10px; font-size: 12px;">
                    Esto puede tardar varios minutos. No cierres la ventana.
                </p>
            </div>
        </div>

        <div id="dashboard" style="display: none;">
            <div class="dashboard">
                <!-- Stats r√°pidas -->
                <div class="full-width">
                    <div class="stats-grid" id="statsGrid"></div>
                </div>

                <!-- Screenshot -->
                <div class="card full-width">
                    <div class="card-header">üì∏ EVIDENCIA VISUAL</div>
                    <div class="card-content screenshot-container">
                        <img id="screenshot" src="">
                    </div>
                </div>

                <!-- Info Objetivo -->
                <div class="card">
                    <div class="card-header">üéØ OBJETIVO</div>
                    <div class="card-content" id="targetInfo"></div>
                </div>

                <!-- WAF / IP -->
                <div class="card">
                    <div class="card-header">üõ°Ô∏è WAF / IP</div>
                    <div class="card-content" id="wafInfo"></div>
                </div>

                <!-- Endpoints -->
                <div class="card">
                    <div class="card-header">üîó ENDPOINTS</div>
                    <div class="card-content" id="endpointsList"></div>
                </div>

                <!-- Hallazgos Sensibles (Telegram, Emails, Keys) -->
                <div class="card half-width">
                    <div class="card-header">üì± TELEGRAM / EMAILS / KEYS</div>
                    <div class="card-content" id="sensitiveList"></div>
                </div>

                <!-- Fuzzing Results -->
                <div class="card full-width">
                    <div class="card-header">üíÄ ARCHIVOS SENSIBLES ENCONTRADOS</div>
                    <div class="card-content" id="findingsList"></div>
                </div>

                <!-- Resultados Completos -->
                <div class="card full-width">
                    <div class="card-header">üìä RESULTADOS DE HERRAMIENTAS</div>
                    <div class="card-content">
                        <div class="tool-output" id="toolResults"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentTaskId = null;
        let statusInterval = null;

        async function startAttack() {
            const url = document.getElementById('targetUrl').value;
            const btn = document.getElementById('attackBtn');
            const statusContainer = document.getElementById('statusContainer');
            const dashboard = document.getElementById('dashboard');
            
            if (!url) {
                alert('Introduce una URL objetivo');
                return;
            }
            
            btn.disabled = true;
            statusContainer.style.display = 'block';
            dashboard.style.display = 'none';
            document.getElementById('progressFill').style.width = '5%';
            document.getElementById('statusMessage').innerText = 'Iniciando ataque masivo...';
            
            try {
                const response = await fetch('/attack', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({url: url})
                });
                
                const data = await response.json();
                currentTaskId = data.task_id;
                
                statusInterval = setInterval(checkStatus, 2000);
                
            } catch (e) {
                alert('Error: ' + e.message);
                btn.disabled = false;
                statusContainer.style.display = 'none';
            }
        }

        async function checkStatus() {
            if (!currentTaskId) return;
            
            try {
                const response = await fetch(`/status/${currentTaskId}`);
                const data = await response.json();
                
                if (data.status === 'running') {
                    document.getElementById('statusMessage').innerText = data.progress;
                    
                    const currentWidth = parseInt(document.getElementById('progressFill').style.width) || 5;
                    if (currentWidth < 90) {
                        document.getElementById('progressFill').style.width = (currentWidth + 2) + '%';
                    }
                    
                } else if (data.status === 'completed') {
                    clearInterval(statusInterval);
                    document.getElementById('progressFill').style.width = '100%';
                    document.getElementById('statusMessage').innerText = '¬°Ataque completado!';
                    
                    setTimeout(() => {
                        showResults(data.data, data.screenshot);
                    }, 1000);
                    
                } else if (data.status === 'not_found') {
                    clearInterval(statusInterval);
                    document.getElementById('statusMessage').innerText = 'Error: Tarea no encontrada';
                }
                
            } catch (e) {
                console.log('Error checking status:', e);
            }
        }

        function showResults(data, screenshotBase64) {
            const statusContainer = document.getElementById('statusContainer');
            const dashboard = document.getElementById('dashboard');
            const btn = document.getElementById('attackBtn');
            
            statusContainer.style.display = 'none';
            dashboard.style.display = 'block';
            btn.disabled = false;
            
            // Stats
            const stats = `
                <div class="stat">
                    <div class="stat-value">${data.telegram?.length || 0}</div>
                    <div class="stat-label">TELEGRAM</div>
                </div>
                <div class="stat">
                    <div class="stat-value">${data.emails?.length || 0}</div>
                    <div class="stat-label">EMAILS</div>
                </div>
                <div class="stat">
                    <div class="stat-value">${data.keys?.length || 0}</div>
                    <div class="stat-label">KEYS</div>
                </div>
                <div class="stat">
                    <div class="stat-value">${data.endpoints?.length || 0}</div>
                    <div class="stat-label">ENDPOINTS</div>
                </div>
            `;
            document.getElementById('statsGrid').innerHTML = stats;
            
            // Screenshot
            if (screenshotBase64) {
                document.getElementById('screenshot').src = 'data:image/png;base64,' + screenshotBase64;
            }
            
            // Target Info
            document.getElementById('targetInfo').innerHTML = `
                <div class="finding info">üåê DOMAIN: ${data.domain}</div>
                <div class="finding info">üìå IP: ${data.ip || 'No resuelta'}</div>
            `;
            
            // WAF Info
            let wafClass = 'info';
            if (data.waf && data.waf !== 'No detectado') wafClass = 'warning';
            document.getElementById('wafInfo').innerHTML = `
                <div class="finding ${wafClass}">üõ°Ô∏è WAF: ${data.waf || 'No detectado'}</div>
            `;
            
            // Endpoints
            if (data.endpoints && data.endpoints.length) {
                document.getElementById('endpointsList').innerHTML = data.endpoints.slice(0, 15).map(e =>
                    `<div class="finding info">üîó ${e}</div>`
                ).join('');
            } else {
                document.getElementById('endpointsList').innerHTML = '<div class="finding">No endpoints detectados</div>';
            }
            
            // Sensitive Info (Telegram, Emails, Keys)
            let sensitiveHtml = '';
            
            if (data.telegram && data.telegram.length) {
                data.telegram.forEach(t => {
                    sensitiveHtml += `<div class="finding telegram">${t}</div>`;
                });
            }
            
            if (data.emails && data.emails.length) {
                data.emails.forEach(e => {
                    sensitiveHtml += `<div class="finding email">${e}</div>`;
                });
            }
            
            if (data.keys && data.keys.length) {
                data.keys.forEach(k => {
                    sensitiveHtml += `<div class="finding key">${k}</div>`;
                });
            }
            
            document.getElementById('sensitiveList').innerHTML = sensitiveHtml || '<div class="finding">No se encontr√≥ info sensible</div>';
            
            // Findings
            if (data.finds && data.finds.length) {
                document.getElementById('findingsList').innerHTML = data.finds.map(f =>
                    `<div class="finding ${f.includes('200') ? 'success' : 'warning'}">${f}</div>`
                ).join('');
            } else {
                document.getElementById('findingsList').innerHTML = '<div class="finding">No se encontraron archivos sensibles</div>';
            }
            
            // Resultados completos
            let resultsText = '';
            if (data.whatweb) resultsText += `üåê WHATWEB:\n${data.whatweb}\n\n`;
            if (data.dnsenum) resultsText += `üì° DNSENUM:\n${data.dnsenum}\n\n`;
            if (data.subfinder) resultsText += `üåç SUBFINDER:\n${data.subfinder}\n\n`;
            if (data.nmap_quick) resultsText += `üîç NMAP R√ÅPIDO:\n${data.nmap_quick}\n\n`;
            if (data.nmap_full) resultsText += `üîç NMAP COMPLETO:\n${data.nmap_full}\n\n`;
            if (data.masscan) resultsText += `üìä MASSCAN:\n${data.masscan}\n\n`;
            if (data.ffuf_common) resultsText += `‚ö° FFUF COMMON:\n${data.ffuf_common}\n\n`;
            if (data.ffuf_medium) resultsText += `‚ö° FFUF MEDIUM:\n${data.ffuf_medium}\n\n`;
            if (data.gobuster_common) resultsText += `üí• GOBUSTER COMMON:\n${data.gobuster_common}\n\n`;
            if (data.gobuster_medium) resultsText += `üí• GOBUSTER MEDIUM:\n${data.gobuster_medium}\n\n`;
            if (data.nikto) resultsText += `‚ö†Ô∏è NIKTO:\n${data.nikto}\n\n`;
            if (data.nuclei) resultsText += `üß¨ NUCLEI:\n${data.nuclei}\n\n`;
            if (data.bypass) resultsText += `üõ°Ô∏è BYPASS:\n${data.bypass}\n\n`;
            
            document.getElementById('toolResults').innerText = resultsText || 'No hay resultados';
        }
    </script>
</body>
</html>
